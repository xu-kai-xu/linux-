[toc]



# 系统介绍与安装

1. 图形界面与字符界面：

   可以通过 <Ctrl+Alt+[F2-F6]> 从图形界面切换到字符界面。

2. 进入字符界面后，可以通过`startx`命令启动图形界面。

3. 永久关闭图形界面：
   `systemctl set-default multi-user.target`

4. 永久开启图形界面：
   `systemctl set-default graphical.target`
   
5. Linux 下命令行不同颜色表示的含义如下：

   - 白色表示是文件；
   - 蓝色表示是目录；
   - 绿色表示是可执行文件；
   - 红色表示是压缩文件；
   - 浅蓝色表示链接文件；
   - 灰色表示其他文件；
   - 红色闪烁表示链接的文件有问题了；
   - 黄色是设备文件；

# linux 文件权限

## 用户操作

1. 添加用户
   `useradd [选项]`

   | 选项       | 说明                                       |
   | ---------- | ------------------------------------------ |
   | -c comment | 修改用户说明                               |
   | -d 目录    | 修改用户所属目录，如果没有该目录会直接创建 |
   | -g 用户组  | 修改用户所属用户组                         |
   | -G 用户组  | 修改用户附加用户组                         |
   | -s shell   | 修改用户登录的 Shell 命令                  |
   | -u 用户号  | 修改用户原有用户号                         |
   
2. 删除用户 `userdel`

3. 修改用户 `usermod [选项]`
   修改用户命令常用选项

   | 选项       | 说明                                       |
   | ---------- | ------------------------------------------ |
   | -c comment | 修改用户说明                               |
   | -d 目录    | 修改用户所属目录，如果没有该目录会直接创建 |
   | -g 用户组  | 修改用户所属用户组                         |
   | -G 用户组  | 修改用户附加用户组                         |
   | -s shell   | 修改用户登录的 Shell 命令                  |
   | -u 用户号  | 修改用户原有用户号                         |
   | -l 用户名  | 修改用户原有的用户名，并指定一个新的用户名 |

   

4. 用户密码管理 `passwd [选项...] <账号名称>`
   密码管理命令常用选项

   | 选项 | 说明                           |
   | ---- | ------------------------------ |
   | 为空 | 修改用户的密码                 |
   | -l   | 锁定密码（禁用账号）           |
   | -u   | 解锁密码（启用被禁用的账号）   |
   | -d   | 使账号无密码                   |
   | -f   | 使用户下次登陆此账号时修改密码 |

   

5. 查看用户

   | 命令  | 说明                                        |
   | ----- | ------------------------------------------- |
   | users | 查看系统当前登录用户                        |
   | who   | 查看 root（超级用户）通过哪一个终端登录系统 |
   | w     | 同 who 命令相似，可以查看更为详细的信息     |

6. 切换用户 `su [选项1] [-] [USER[AGR]...]`
   切换用户命令`选项1`常用选项

   | 选项                              | 说明                                        |
   | --------------------------------- | ------------------------------------------- |
   | -m 或 -p 或 –preserve-environment | 切换身份时不改变环境变量                    |
   | -G 或 --supp-group <组>           | 指定一个辅助组                              |
   | -l 或 --login                     | 使 Shell 成为登陆 Shell                     |
   | -c 或者 --command <命令>          | 使用 -c 向 Shell 传递一条命令               |
   | --session-command <命令>          | 使用 -c 向 Shell 传递一条命令而不创建新会话 |
   | -f 或 –fast                       | 向 Shell 传递 -f 选项（csh 或 tcsh）        |
   | -s 或 --shell \<shell>            | 若 /etc/shells 允许，则运行 Shell           |
   | ARG                               | 传入新 Shell 参数                           |

   > 关于`su`与`su - `的区别：`su`仅仅切换用户身份，`su - `切换用户身份和**Shell环境**。

## 用户组操作

1. 添加用户组 `groupadd [选项] 组`

   | 选项   | 说明                                                      |
   | ------ | --------------------------------------------------------- |
   | 为空   | 创建指定用户组                                            |
   | -g GID | 创建新用户组并指定用户组的GID                             |
   | -o     | 与 -g 选项同时使用，表示可以和已有的用户组同时使用一个GID |

   

2. 删除用户组 `groupdel [选项] 组`

3. 修改用户组 `groupmod [选项] 组`

   | 选项        | 组                                                     |
   | ----------- | ------------------------------------------------------ |
   | -g GID      | 修改用户组的 GID，为用户组重新指派标识符               |
   | -o          | 与 -g 同时使用，表示可以与已有的用户组同时使用一个 GID |
   | -n 新用户组 | 更改用户组名                                           |

   

## 目录管理

1. 查看路径当前目录的绝对路径 `pwd`

2. 切换路径 `cd`
   `cd`命令的选项

   | 选项      | 说明                         |
   | --------- | ---------------------------- |
   | 目录名    | 切换到指定目录               |
   | ~         | 切换到当前用户的默认工作目录 |
   | ~用户名   | 切换到指定用户的默认工作目录 |
   | .. 或 ../ | 切换到上级目录               |
   | /         | 切换到根目录                 |
   | 为空      | 切换到主目录                 |

## 目录操作

1. 显示目录列表，查看指定目录下的文件 `ls [选项]... [文件]...`
   `ls -al`命令查看指定目录下文件的全部信息

   > \- rw- r-- r-- 1 xu_kai root   12 2月   4 00:32 test1.txt

   第一部分是[文件类型和权限](#1. 权限)，`\- rw- r-- r--`;
   第二部分表示多少文档名连接到此节点，即1；
   第三部分表示文件拥有者的账号，xu_kai;
   第四部分表示文件的所属群组，root；
   第五部分表示文件大小，12kb；
   第六部分表示文件的最近修改日期；
   第七部分是文件的名字。
2. 创建目录 `mkdir [选项]... 目录...`

   | 选项 | 说明                       |
   | ---- | -------------------------- |
   | 为空 | 创建指定目录               |
   | -m   | 创建目录的同时设置存取权限 |
   | -p   | 递归创建目录               |
3. 删除目录 `rmdir [选项] 目录`

   | 选项 | 说明                                                         |
   | ---- | ------------------------------------------------------------ |
   | -p   | 删除指定目录后，若该目录的上层目录已经变成空目录，则将其一并删除 |
   | -v   | 显示命令的详细执行过程                                       |

## **文件管理**

1. 创建文件 `touch [选项]... 文件... `

   | 选项   | 说明                                 |
   | ------ | ------------------------------------ |
   | -a     | 改变文件的访问时间为当前系统时间     |
   | -m     | 改变文件的修改时间为当前系统时间     |
   | -c     | 如果文件存在则不创建                 |
   | -d/ -t | 设置指定的日期时间                   |
   | -r     | 使指定内容的日期时间与参考内容的相同 |

2. 文件查询 `find 目录名 [选项] 范围`
   `find`命令的选项与范围

   | 选项 + 范围                         | 格式介绍                                                   |
   | ----------------------------------- | ---------------------------------------------------------- |
   | -name + [文件名]                    | 查找指定目录下所有名为指定名字的文件                       |
   | -name '*.[后缀]'                    | 查找指定目录下所有后缀为指定后缀的文件                     |
   | -name "[A-Z]*"                      | 查找指定目录下所有以大写字母开头的文件                     |
   | -size [文件大小]                    | 查找指定目录下等于指定文件大小的文件                       |
   | -size +[文件大小]                   | 查找指定目录下大于指定文件大小的文件                       |
   | -size -[文件大小]                   | 查找指定目录下小于指定文件大小的文件                       |
   | -size +[文件大小] -size -[文件大小] | 查找指定目录下大于前指定文件大小，小于后指定文件大小的文件 |
   | -perm [文件权限]                    | 查找指定目录下权限为指定文件权限的文件或者目录             |

3. 查看文件内容 `cat [选项]... [文件]...`
   `cat`命令常用选项

   | 选项 | 说明                                   |
   | ---- | -------------------------------------- |
   | -A   | 查看所有文件                           |
   | -n   | 对输出的一切行编号                     |
   | -b   | 对非空输出行编号                       |
   | -c   | 等价于 -vE                             |
   | -E   | 在每行完毕后显现 $                     |
   | -s,  | 不输出多行空行                         |
   | -t   | 与 -vT 等价                            |
   | -T   | 将跳字符显现为 ^I                      |
   | -v   | 运用 ^ 和 M- 引证，除了 LFD 和 TAB之外 |

4. 删除文件 `rm [选项]... 文件...`
   `rm`命令常用选项

   | 选项 | 说明                 |
   | ---- | -------------------- |
   | -f   | 忽略文件不存在的问题 |
   | -i   | 在删除时需要手动确认 |
   | -r   | 递归删除目录及其内容 |

5. 移动与重命名 `mv [选项]... [-T] 源文件 目标文件`
   `mv [选项]... 源文件... 目录`
   `mv [选项]... -t 目录 源文件...`
   `mv`命令选项

   | 选项 | 说明                             |
   | ---- | -------------------------------- |
   | -i   | 提示是否覆盖的信息，需要手动确认 |
   | -f   | 不给提示，直接覆盖               |
   | -v   | 显示详细的进行步骤               |

6. 复制文件/目录 `cp [选项]... [-T] 源文件 目标文件`
   `cp [选项]... 源文件... 目录`
   `cp [选项]... -t 目录 源文件...`

   | 选项 | 说明                           |
   | ---- | ------------------------------ |
   | -a   | 保留所有的信息，并递归复制目录 |
   | -r   | 递归复制目录                   |
   | -V   | 显示详细的进行步骤             |

7. 压缩文件 `tar [选项...] [FILE]...`
   `tar`命令常用选项

   | 选项  | 说明                               |
   | ----- | ---------------------------------- |
   | -c    | 创建打包文件                       |
   | -v    | 显示进度                           |
   | -f    | 指定打包文件名，一定是最后一个选项 |
   | -t    | 列出包中包含的文件                 |
   | -x    | 解开包文件                         |
   | -zcvf | 指定压缩包格式为 xxxx.tar.gz       |
   | -zxvf | 解压 xxxx.tar.gz 格式的压缩包      |
   | -jcvf | 指定压缩格式为 xxxx.tar.bz2        |
   | -jxvf | 解压 xxxx.tar.bz2 格式的压缩包     |

8. 修改文件用户组 `chgrp [选项] 组 文件`
   `chgro` 命令选项

   | 选项            | 说明                                     |
   | --------------- | ---------------------------------------- |
   | -c              | 当发生改变时输出调试信息                 |
   | -f              | 不显示错误信息                           |
   | -R              | 处理指定目录以及其子目录下的所有文件     |
   | -v              | 运行时显示详细的处理信息                 |
   | -dereference    | 作用于符号链接的指向，而不是符号链接本身 |
   | -no-dereference | 作用于符号链接本身                       |

9. 修改文件用户组与用户组 `chown [选项] user[:group] file...`
   `chown`命令选项

   | 选项  | 说明                                                   |
   | ----- | ------------------------------------------------------ |
   | user  | 新的文件拥有者的使用者                                 |
   | group | 新的文件拥有者的使用者群体                             |
   | -c    | 若该文件拥有者确实已经更改，才显示其更改动作           |
   | -f    | 若该文件拥有者无法被更改也不要显示错误信息             |
   | -h    | 只对于链接（link）进行变更，而非该link真正指向的文件   |
   | -v    | 显示拥有者变更的详细资料                               |
   | -R    | 对目前目录下的所有文件与子目录进行相同操作的拥有者变更 |

10. `mv [选项] source dest`:

    `mv [选项] source... directory`
    为文件或目录改名、或将文件目录移入其他位置

## 权限控制

### 1. 权限

权限一共有 10 位，代表的含义如下：

> **d rwx r-x r-x**

第一位是文件类型的说明，主要选项如下表所示：

| 选项 | 说明                             |
| ---- | -------------------------------- |
| d    | 目录                             |
| -    | 文件                             |
| l    | 链接文件                         |
| b    | 装置文件里面的可供存储的接口设备 |
| c    | 装置文件里面的串行端口设备       |

其余 9 位中，每三位分为一组，且均以 rwx选项的形式组合，分别代表**可读，可写，可执行**，从左到右三个组分别为

> 文件拥有者的权限；
>
> 同群组的权限；
>
> 其他群组的权限。

在使用 Linux 系统时需要遵循最小特权原则。在完成某种操作时，赋予用户所必需的最小特权，确保当系统遭遇事故、错误、篡改等问题时，造成的损失下降到最小。

正常操作时使用普通用户，荡需要 root 权限时，调用`sudo`命令实现。
`sudo [选项] [命令]`

| 选项        | 说明                                                         |
| ----------- | ------------------------------------------------------------ |
| -b          | 在后台执行指令                                               |
| -H          | 将 HOME 环境变量设为新身份的 HOME 环境变量                   |
| -k          | 结束密码的有效期限                                           |
| -l          | 列出目前用户可执行与无法执行的指令                           |
| -p          | 改变询问密码的提示符号                                       |
| -s \<shell> | 执行指定的 shell                                             |
| -u \<用户>  | 以指定的用户作为新的身份。若无此选项，则默认设以 root 作为新的身份 |

在使用 `sudo`命令之前需要先配置 /etc/sudoers 文件，使用`visudo`命令打开文件，在`root	ALL=(ALL)		ALL`下配置`username	ALL=(ALL)  ALL`。其中，username 是用户名；第一个 ALL 是网络中的主机；第二个 ALL 是目标用户；第三个 ALL 是命令。



### 2.  `chmod`命令

文件的权限可以通过`chmod`命令来设置，格式如下：
`chmod [选项]... 模式[, 模式]... 文件...`
`chmod [选项]... 八进制模式 文件...`
`chmod [选项]... --reference=参考文件 文件..`

1. 权限可以用 rwx 三个的值相加所得的数值，rwx 分别对应4、2、1的值，所以当 rwx 都有权限时对应的值为 4+2+1=7。

2. 除了用数值直接改变权限之外，还有一种用符号类型直接改变文件权限的方式：`chmod [u/g/o/a][+/-/=][r/w/x] 文件名`
   `chmod`命令常用选项

   | 选项 | 说明           |
   | ---- | -------------- |
   | u    | 代表文件拥有者 |
   | g    | 代表同组者     |
   | o    | 代表其他组     |
   | a    | 代表所有人     |
   | +    | 代表添加某权限 |
   | -    | 代表除去某权限 |
   | =    | 代表设定某权限 |

### 默认权限与`umask`命令

1. `umask`命令是指定目前用户新建文件或目录时的权限默认值。
   使用`umask`命令查看权限设置分数的方法有两种，一种是直接在终端输入`umask`，可以直观地看到数字形态的权限设置分数；一种是加入`-S`选项，会以符号类型的方式来显示出权限。查看默认权限的代码如下：
   `umask`

   \> `0022`
   四个数字分别对应`0ugo`

   `umask -S`
   \> `u=rwx, g=rx, o=rx`

2. 对于目录与文件而言默认权限是不一样的，`x`权限对于目录非常重要，但是一般文件在创建时通常用于记录数据而不应该有执行的权限，因此在创建文件与目录的默认情况下的权限应该有不同：

   > 在用户创建文件时，默认不执行`x`权限，只有`r`、`w`这两个选项，所以最大为 666，默认权限为`- rw- rw- rw-`；

   

   > 在用户新建目录时，由于`x`与是否可进入此目录有关，因此默认所有的权限均开放，最大为 777，默认权限为`d rwx rwx rwx`。

3. `umask`命令同`chmod`命令一样，可以通过数值来改变默认权限，但不一样的是，`umask`命令的数值指的是该默认值需要去掉的权限，即数值上是用减法。
   `umask`数值

   | 去掉的权限 | 减去的数值 |
   | ---------- | ---------- |
   | w          | 2          |
   | r          | 4          |
   | w 和 r     | 6          |
   | r 和 x     | 5          |
   | w 和 x     | 3          |

4. 例如，当`umask`的值为 0022 时，用户新建文件与目录时的权限如下所示：

   1. 新建文件：（`- rw- rw- rw-`）- (`- --- -w- -w-`) = `- rw- r-- r-- `;
   2. 新建目录： (``d rwx rwx rwx`) - (`d --- -w- -w-`) = `d rwx r-x r-x`。

   所以如果设定`umask`的值为 0022 时，新建的文件只有用户自己有写入的权限，同用户组的人只有读的权限，无法修改。所以，当需要创建文件给同组的用户共同编辑时，用户组就不能拿掉`w`的权限，`umask`命令需要 0002 之类的数值才可以，这样新建的文件才能是`- rw- rw- r--`的权限模式。

5. 设置默认权限的代码：`umask 0002`或者`umask 0022`。

6. 如果文件`umask`的值为 0003 时，用户新建文件与目录时的权限如下所示：

   1. 新建文件：（`- rw- rw- rw-`）- (`- --- --- -wx`) = `- rw- rw- r-- `;
   2. 新建目录： (`d rwx rwx rwx`) - (`d --- --- -wx`) = `d rwx rwx r--`。

## 任务 2

在 root 用户下新建三个用户和两个用户组。其中一个用户添加到一个用户组，另外两个用户添加到另一个用户组。在含有两个用户的组中选择一个用户创建文件，然后通过改变文件权限使同组用户可以操作该文件。

1. 新建用户和用户组：
   `useradd user1`
   `useradd user2`
   `useradd user3`
2. 修改用户密码：`passwd user1`
3. 创建用户组：`groupadd group1`, `groupadd group2`
4. user1 添加到用户组 group1，user2 和 user3 添加到用户组 group2：
   `usermod -G group1 user1`
   `usermod -G group2 user2`
   `usermod -G group2 user3`
5. …
6. 修改文件的用户与用户组：
   `chown -R user2:group2 /home/user2/dir1/test.txt`
7. 修改文件的权限：
   `chmod 770 /home/user2/dir1/test.txt`
8. 更换账户后修改文件名：`mv test.txt test1.txt`。

# linux 磁盘与文件系统

文件系统、磁盘和外部存储的概念；熟悉磁盘查看、分区、格式化和挂载的命令与操作，掌握对外部存储设备挂载的操作。

## 磁盘

磁盘是通过对硬盘分区而产生的虚拟概念。

### 2. 磁盘基本参数

容量：硬盘的生产商是按照 1MB=1000KB 计算生产的。

转速：硬盘内主轴的旋转速度，硬盘盘片在一分钟内能完成最大的转数，直接影响到硬盘对文件的传输速率。转速越高，读写速度越快。

| 主机类型 | 转速                                   |
| -------- | -------------------------------------- |
| 台式机   | 5400,7200 rpm (Revolutions per minute) |
| 笔记本   | 4200,5400                              |



传输速率：硬盘对数据的传输速度，MB/s。

缓存：硬盘控制器上的一块内存芯片，具有极快的存取速度，是硬盘与外部接口之间的缓冲器。

### 3. 磁盘相关命令

1. 磁盘查看：`lsblk [选项...] <磁盘名称>`

   | 选项 | 说明                                       |
   | ---- | ------------------------------------------ |
   | 为空 | 以树状列出所有块设备                       |
   | -d   | 仅列出磁盘本身，并不会列出该磁盘的分区数据 |
   | -f   | 同时列出该磁盘内的文件系统名称             |
   | -i   | 使用 ASCII 的线段输出                      |
   | -m   | 同时输出该设备在 /dev 底下的权限数据       |
   | -p   | 列出该装置的完整文件名                     |
   | -t   | 列出该磁盘装置的详细数据                   |

2. 磁盘参数相关命令：`blkid`
   查看 UUID （通用唯一识别码）等参数。

## 文件系统

1. 简介：文件系统用于确定如何在存储设备上组织文件。

### 2. 常见文件系统的格式

1. FAT 文件系统：文件分配表系统，FAT16，FAT32，最大支持的单个文件为 4GB。
2. NTFS 文件系统：最大支持单个文件 2TB，微软注册知识产权。
3. exFAT 文件系统：微软为闪存（例如SD卡）而设计的文件系统，常用于 U 盘等闪存设备，不适用于硬盘。
4. EXT 文件系统：Extended file system（扩充文件系统），是 linux 系统的第一个文件系统，格式化较慢。
5. XFS 文件系统：擅长处理大文件，提供平滑的数据传输。包含如下 4 个特性：
   - 数据完整性：开启了日志文件功能，发生意外死机后，可以根据日志文件在短时内回复数据内容。
   - 传输特性：性能最为出众。
   - 可扩展性：是一个 64 位的文件系统，支持上百万 TB 字节存储。最大支持文件的大小为 9EB，最大的系统文件尺寸为 18EB。
   - 传输带宽：吞吐量最高可达 7GB/s，对单个文件的吞吐量可达到 4GB/s。

### 4. 文件系统工作原理

操作系统中除了文件的实际数据外，还存储了文件权限和文件属性。

<center>文件系统的组成部分</center>
| 名称       | 说明                                                         |
| ---------- | ------------------------------------------------------------ |
| superblock | 记录文件系统的整体信息，包括 inode 和 block 的总量、剩余量和使用量，以及文件系统的格式与相关文件。 |
| inode      | 记录文件的属性，一个文件占用一个 inode，同时记录此文件的数据数据所在的 block 号码。 |
| block      | 实际记录文件的内容，若文件太大时，会占用多个 block。         |

1. 索引式文件系统：由于 inode 会存储 block 的号码，所以如果找到了一个文件的 inode，就可以通过 inode 记录的 block 号码找到文件的实际数据存储的块（即，物理存储位置），也就可以找到文件的实际数据。

   ![索引式文件系统](F:\lessons\linux\索引式文件系统.jpg)

2. 图中每个 inode 与 block 都有自己相应的编号，而每个文件都会占用一个 inode。inode 会存储文件的相关属性和文件数据对应块的编号。因此如果可以找到编号为 4 的 inode，就可以从 inode 读取出文件对应块的信息，进而找到 Block2、Block7、Block13、Block15 四个块，操作系统就可以按照顺序将文件内容读取出来。

### 5. 文件系统常用命令

文件磁盘的整体数据存储在 superblock 中，每个容量的相关信息存在 inode 中。

1. 查看文件系统整体磁盘使用量：`df [选项] <目录或文件名>`
   `df`命令常用选项

   | 选项 | 说明                                            |
   | ---- | ----------------------------------------------- |
   | 为空 | 默认会将系统内所有的都已 1KBytes 的容量列出来   |
   | -a   | 推算目录所占容量                                |
   | -k   | 列出所有的文件系统，包括特有的 /proc 等文件系统 |
   | -m   | 区块为 1 048 576 字节                           |
   | -h   | 以人们较易阅读的 GB，MB，KB等格式自行显示       |
   | -H   | 等价于 -h，但是计算式，1K=1000，而不是 1k=1024  |
   | -T   | 以 M=1000K 取代 M=1024K 的进位方式              |
   | -i   | 不用磁盘容量，而以 inode 的数量来显示           |

2. 针对文件夹的命令：`du [选项] <目录或文件名>`

   | 选项 | 说明                                                         |
   | ---- | ------------------------------------------------------------ |
   | 为空 | 列出系统所有文件夹，并显示其个数                             |
   | -a   | 列出所有的文件与目录容量，因为默认情况下仅统计目录底下的文件量 |
   | -h   | 以较易读的容量格式（GB，MB）显示                             |
   | -s   | 列出总量，而不分别列出每个目录占用的容量                     |
   | -S   | 不包括子目录下的总量                                         |
   | -k   | 以 KB 列出容量显示                                           |
   | -m   | 以 MB 列出容量显示                                           |

## 磁盘管理

### 1. 分区：

将硬盘分割成若干块的区域，用来存放不同类型的数据。传统硬盘分区可以分为两类：主分区和扩展分区。主分区一般用来存放操作系统，而扩展分区则用于存储除操作系统之外的其他文件。

1. 硬盘分区表：操作系统通过硬盘分区表将硬盘分为若干区域。常见的分区方案有两种，MBR 分区表和 GPT 分区表。

   1. MBR：全称是主引导记录，存在于驱动器的开始部分的一个特殊启动扇区内，包含了已经安装的操作系统的启动器和逻辑分区信息。
   2. GPT：全局唯一表示分区。

2.  parted 分区管理工具：

   查看硬盘信息：`parted /dev/sda print`

3. 硬盘分区命令：
   `gdisk`
   `fdisk [必要选项] [可选选项]`
   分区命令选项

   | 参数名称      | 说明                         |
   | ------------- | ---------------------------- |
   | 必要选项      |                              |
   | -l            | 列出所有分区表               |
   | -u            | 与 -l 搭配使用，显示分区数目 |
   | 可选选项      |                              |
   | -s <分区编号> | 指定分区                     |
   | -v            | 版本信息                     |

4. 如果要对硬盘进行分区操作，需要输入 `gdisk/fdisk [文件目录]`进入 gdisk/fdisk 工具。
   分区工具命令选项

   | 选项 | 说明                   |
   | ---- | ---------------------- |
   | m    | 显示菜单和帮助信息     |
   | a    | 活动分区标记、引导分区 |
   | d    | 删除分区               |
   | l    | 显示分区类型           |
   | n    | 新建分区               |
   | p    | 显示分区信息           |
   | q    | 退出不保存             |
   | t    | 设置分区号             |
   | v    | 进行分区检查           |
   | w    | 保存修改               |
   | x    | 扩展应用，高级功能     |

### 2. 磁盘格式化

系统分区后，需要进行格式化才能使用。**格式化就是安装文件系统**。磁盘格式化的命令：`mkfs [选项] 磁盘名称`
磁盘格式化命令参数

| 选项  | 参数附加值      | 说明                                       |
| ----- | --------------- | ------------------------------------------ |
| -V    |                 | 显示详细模式                               |
| -t    | xfs，ext4，ext3 | 格式化磁盘并将文件系统改为指定参数的附加值 |
| -c    |                 | 可以检查是否有坏轨                         |
| block |                 | 给定 block 的大小                          |

**注意**：

1. 格式化会将文件原有数据清空；
2. 命令附加值如果不填写单位，默认是 Bytes，可以使用k、m、g、p （小写）来解释。
3. `mkfs`加两个 Tab 键可以查看系统支持的所有文件系统。



### 3. 磁盘挂载

> 磁盘挂载是指将一个设备（存储设备）挂接到一个已经存在的目录上（可以在挂载时创建）。

如果想要访问驱动器，必须将文件所在的分区挂载到一个目录上，通过目录访问存储设备。在挂载磁盘时，如果原来被挂载的目录不是空的，那么原来目录的东西会暂时无法查看。卸载掉分区后，该文件内容就会再次被读取出来。所以在此建议：

> 如果需要挂载磁盘，创建一个新文件夹进行挂载。

1. 磁盘挂载命令：`mount [选项] [挂载设备] [目标文件名]`
   磁盘挂载常用参数

   | 选项                    | 说明                                                         |
   | ----------------------- | ------------------------------------------------------------ |
   | -V                      | 显示程序版本                                                 |
   | -h                      | 显示帮助信息                                                 |
   | -a                      | 将 /etc/fstab 中定义的所有档案系统挂上                       |
   | -F                      | 通常和 -a 一起使用，为每一个 mount 动作产生一个行程负责执行，可以加快挂载的动作 |
   | -t [指定档案系统的形态] | 指定档案系统的形态，通常不必指定                             |
   | -o ro                   | 使用只读模式挂载                                             |
   | -o rw                   | 使用可读写模式挂载                                           |
   | -L                      | 将含有特定标签的硬盘分割挂载                                 |

### 4. 逻辑卷

逻辑卷全称为逻辑卷分区。在为磁盘分区之后，基本磁盘分区不能随意扩展。如果想要将磁盘分为更多的区域，只能采用逻辑分区的方法。逻辑分区读写速率低于普通磁盘，但其拥有灵活的设备管理方式。

逻辑卷的创建过程：从安装硬件设备开始，硬件设备被创建成为物理卷（PV），在物理卷上较为分散的各物理卷的存储空间组成卷组（VG），最后在卷组上可以分割不同的逻辑卷。

## 外部存储设备

u 盘、光盘、软盘、移动硬盘

1. 外部存储设备挂载：如果想要访问外部存储设备，需要将设备挂载到本地的文件夹中，使用挂载命令，用户可以从系统中访问到该设备。挂载外部设备的命令格式如下：
   `mount -t type device dir`
   参数说明：
   - mount：挂载命令；
   - -t type：指定文件系统类型，通常不必指定，mount 会自动选用正确的状态；
   - device：需要挂载的设备；
   - dir：目标文件夹。

## 任务 3

在 linux 系统添加磁盘完成后对新磁盘进行格式化为 xft 文件系统，然后对磁盘进行分区与挂载，之后将新添加的硬盘取消挂载，重新格式化为 ext4 文件系统。

1. 虚拟机添加虚拟硬盘，实体主机添加实体硬盘。
2. 查看添加硬盘的信息：`lsblk`
   新硬盘的名称为 **sdb**。
3. 添加硬盘成功后，对硬盘进行分区。用到`fdisk`工具：
   `fdisk /dev/sdb`
   其中，sdb 为新硬盘的名字。进入`fdisk`工具之后，输入`m`查看`fdisk`工具提供的操作。
4. 通过给出的命令选项完成分区：
   `Command (m for help):n (add a new partion)`
   `Select (default p): e (extended)`
   `Partion number (1-4, default 1): 1`
   `First sector (2048-4943093, default 2048): 2048`
   `Last sector, +sectors or +size {K, M, G} (2048-41943093):`
5. 保存分区结果：
   `Command (m for help): w`
   `The partion table has been altered !`
6. 对重新创建的分区进行格式化，文件系统为 xfs：
   `mkfs -t xfs /dev/sdb`
7. 通过`blkid`命令查看格式化完成的分区的文件系统格式：
   `blkid`
8. 将分区好的磁盘进行挂载，重新启动系统。
   `vim /etc/fstab # 打开文件 fstab，然后在文件中增加一行命令`
   `/dev/sdb  /opt xfs defaults 1 1`
   该命令中，`/dev/sdb` 是硬盘的目录，`sdb` 是硬盘的名字。`/opt` 是硬盘挂载的目录，`xfs` 是硬盘文件系统的格式。
   写入命令后，按`esc`键退出编辑状态，然后在最后一行输入`:wq`保存并关闭文件。 
9. 重启系统：`reboot`。
10. 重启后使用`mount`查看，可以查到硬盘目录和挂载目录。
11. 再使用命令`lsblk`查看查看新硬盘的挂载目录（本例中为`/opt`）。
12. 然后进入硬盘挂载的文件夹，在文件夹上创建文件夹或者文件，证明该分区可以使用。



# Linux 文本与编辑器

## Vim 编辑器

1. 没有图形界面，不能进行文档排版，在编辑可执行脚本时，Vi 可对单词进行高亮显示。

2. 在编辑文件时 Vim 会将当前所编辑的内容存储到暂存缓存区。

3. 文件路径中若存在要编辑的文件则直接打开并显示源文件中的内容，若文件不存在则会执行新建操作。
   `vim [选项] [文件路径...] # 编辑指定文件`
   `vim [选项] # 在标准输入设备中读取内容`
   vim 命令常用选项

   | 选项 | 说明                   |
   | ---- | ---------------------- |
   | --   | 在该选项后加文件名即可 |
   | -v   | Vi 编辑器模式          |
   | -e   | Ex 编辑器模式          |
   | -E   | 改进的 Ex 编辑器模式   |

### 2. vim 模式切换

插入模式和执行命令模式。

1. 普通模式：文本阅读功能。通过按键\<a> (append) 或 \<i> (insert) 切换到插入模式。
   `vim /var/lgo/secure`

2. 插入模式：在插入模式下终端窗口左下角显示`--INSERT--`字样。在插入模式中可向文本缓冲区插入文本。在该模式下可以使用 \<Esc> 键切换到普通模式。

3. 可视模式：在可视模式下可以通过按光标移动键选中一个文本区域（一行一个文本或一个文本块）。Vim 会将选中的区域进行高亮显示，被选中区域可以通过快捷键进行删除和修改等操作。可视模式激活方式见下表：

   | 激活方式   | 说明         |
   | ---------- | ------------ |
   | v（小写）  | 选择逐个字符 |
   | V （大写） | 逐行选择文本 |
   | <Ctrl+v>   | 选择块文本   |

   将光标定位到文档头（敲击两下“g”键）

4. 命令模式：在普通模式下，按下“ : ”按键即可进入命令模式（该模式下终端窗口左下方会显示“ : ”字样）。
   在命令模式下可以执行 Vim 提供的指令或插件提供的指令，如环境设置、文本操作、功能调用等。

### 3. Vim 基础操作

1. Vim 参数：Vim 命令常用参数

   | 参数 | 说明                     |
   | ---- | ------------------------ |
   | -v   | 以 Vi 编辑器方式打开文件 |
   | -R   | 以只读方式打开文件       |
   | -b   | 以二进制方式打开文件     |
   | -D   | 以更正模式打开文件       |
   | -y   | 以简单模式打开文件       |

2. 文件操作：打开文本文件并进行操作，同时打开一个或多个文件。

   | 命令                    | 说明                                                |
   | ----------------------- | --------------------------------------------------- |
   | vim file                | 打开文件或创建文件                                  |
   | vim file1, file2, file3 | 同时打开多个文件                                    |
   | :open file              | 在新窗口中打开文件                                  |
   | :bn                     | 切换到上一个文件                                    |
   | :bp                     | 切换到下一个文件                                    |
   | :args                   | 查看当前打开的文件列表                              |
   | :w filename             | 将暂存缓冲区的内容写入 filename 文件中              |
   | :r filename             | 在当前光标位置插入其他文件中的内容                  |
   | :w! filename            | 将暂存缓存区的内容强制写入 filename 文件中          |
   | :q                      | 在未对文档做任何编辑操作时可用此命令退出 Vim 编辑器 |
   | :w                      | 将暂存缓存区的内容保存到使用 Vim 命令打开的文本中   |
   | :wq                     | 与 :w 类似，此命令保存文件后会退出 Vim 编辑器       |
   | :q!                     | 强制退出 Vim 编辑器，并放弃修改                     |
   | :w!                     | 强制保存，使用于文件所有者和超级用户修改只读文件    |
   | :wq!                    | 强制保存并退出 VIm 编辑器                           |

   使用 Vim 打开两个文件，但不会同时打开两个终端窗口，而是将第一个文件输出到显示设备，将第二个文件存储到暂存缓存区。
   
   在打开多个文件时可以在普通模式下输入<:bp>切换到下一个文件或输入<:bn>回到上一个文件。

3. 光标移动：在 Vim 编辑器中定位光标的位置只能通过快捷键的方式完成。
   光标移动快捷键

   | 命令              | 说明                                      |
   | ----------------- | ----------------------------------------- |
   | h/j/k/l           | 向左、向下、向上、向右移动                |
   | w/b               | 定位到光标所在位置的下一个/上一个单词开头 |
   | e/ge              | 下一个/上一个单词结尾                     |
   | W/B               | 和 w/b 相同，但跳过符号                   |
   | 0                 | 光标所在行的第一个字符上                  |
   | ^                 | 光标所在行的第一个非空字符上              |
   | $                 | 光标所在行的结尾                          |
   | %                 | 查找匹配的括号                            |
   | { / }             | 定位到光标所在位置的上一段/下一段         |
   | gg                | 定位到文件开头                            |
   | G                 | 定位到文件结尾                            |
   | :line             | 跳转到第 line 行                          |
   | <Ctrl+d>/<Ctrl+u> | 向前 / 向后翻动半页                       |
   | <Ctrl+f>/<Ctrl+b> | 向前 / 向后翻页：                         |

4. 查找命令：查找单词，高亮显示
   查找命令

   | 命令            | 说明                                                         |
   | --------------- | ------------------------------------------------------------ |
   | /text           | 在文件中查找 text，按 n/N 键查找下一个/上一个（被搜索到的文本会高亮显示，使用`noh`命令可以取消高亮显示） |
   | *               | 查找文件中所有与光标所在位置相同的单词                       |
   | :set ignorecase | 使用搜索命令时忽视大小写                                     |
   | :set hlsearch   | 使用搜索命令时将搜索到的文本高亮显示                         |
   | :set incsearch  | 逐步搜索，对当前输入的进行搜索                               |
   | :set wrapscan   | 取消上一次的搜索                                             |

5. 编辑命令：Vim 默认打开状态为普通模式，不可进行编辑。转换到编辑模式才能对文本进行编辑。
   编辑命令

   | 命令                     | 说明                                           |
   | ------------------------ | ---------------------------------------------- |
   | i/a                      | 当前位置之前/之后插入                          |
   | I/A                      | 当前行行首/行尾插入                            |
   | o/O                      | 当前行之后/之前插入                            |
   | s/old/new                | 将字符 old 替换为 new，只替换一个              |
   | [%line1, line2]s/old/new | %，替换全文；line1， line2，替换两行之间的内容 |
   | x                        | 删除当前字符                                   |
   | X                        | 删除当前字符的前一个字符                       |
   | dd/dj/dk                 | 删除当前行、上一行、下一行                     |
   | yy                       | 拷贝当前行                                     |
   | p/P                      | 在光标所在行后或行前粘贴                       |
   | :1,10 co 20              | 1 到 10 行复制到第 20 行之后                   |
   | :1,10 m 2o               | 1 到 10 行移动到第 20 行之后                   |

6. 窗口命令：在遇到需要两个文件对比编辑的情况下，可同时开启两个并行的窗口对文本进行操作，并能通过快捷键的方式在两个窗口间进行切换。
   窗口切换命令
   
   | 命令             | 说明                                   |
   | ---------------- | -------------------------------------- |
   | new/split/vsplit | 打开一个窗口，最后一个水平             |
   | <Ctrl>+w+方向    | 移动到指定窗口                         |
   | :close/q         | 关闭窗口，如果只有一个窗口，会退出 Vim |
   
7. 控制命令：操作错误或错误地执行了某条指令时，需要撤销当前的错误操作，将文件退回到发生错误之前的状态。
   控制命令

   | 命令 | 操作                              |
   | ---- | --------------------------------- |
   | u    | 撤销命令，相当于 Word 中的 Ctrl+Z |
   | U    | 取消光标所在行的所有操作          |

   

## Sed 工具

贝尔实验室提出的非交互式流编辑器（流是指接收标准的输入，然后将其输出到标准输出），适用于处理大数据文件。读取文件内容但默认并不直接修改源文件。将读入的内容复制到模式空间（临时缓冲区），然后根据指令对模式空间中的内容进行处理并输出结果。

使用 Sed 读取数据文件时，若遇到没有数据文件的情况，Sed则会默认对标准输入进程数据进行管理，其中脚本指令是指第一个非“-”开头的参数。

Sed 基础命令格式如下：
`sed [选项]... {脚本指令} [输入文件]...`

### Sed 语法规则

sed 命令后可加选项与脚本指令，以下是对选项与指令的具体介绍。

1. 选项：使用 sed 脚本命令操作文件时，源文件的内容并不会被修改。想使用 sed 脚本更改源文件或将修改后的源文件输出到屏幕时，需要使用 sed 命令的可选项：
   sed 命令脚本选项

   | 选项      | 示例                                 | 说明                                   |
   | --------- | ------------------------------------ | -------------------------------------- |
   | --version | sed --version                        | 显示 sed 版本                          |
   | –help     | sed –help                            | 显示帮助文档                           |
   | -n        | sed -n ‘1p’ test.txt                 | 只显示处理后的结果，不覆盖原文档       |
   | -e        | sed -e ‘y/i/I/’ -e ‘y/L/l/’ test.txt | 以选项中指定的脚本来处理输入的文本文件 |
   | -f        | sed -f sed.sh test.txt               | 以选定的脚本文件来对文本文件执行操作   |
   | -i        | sed -i ‘y/L/l/’ test.txt             | 直接修改原文件                         |
   1. 使用脚本命令在第二行后增加 Line2.5：

      ```sed.sh
      # sed.sh 在文本的第二行后增加一行
      
      2a Line2.5
      ```

   2. 使用包含 `-e`的脚本指令删除 test.txt 的第二行并将 Line4 替换为 Line 10：
      `sed -e ‘2d’ -e ‘s/Line4/Line1/' test.txt`

2. 脚本指令：通过使用 sed 脚本指令可对指定的文件进行**添加删除修改替换**等操作，指令详解见下表：
   sed 命令详解

   1. | 命令 | 示例                          | 说明                                                 |
      | ---- | ----------------------------- | ---------------------------------------------------- |
      | a    | sed ‘2a Line2.5’ test.txt     | 在第2行后插入内容（不修改源文件）                    |
      | c    | sed ‘2c Lin1’ test.txt        | 将第2行替换为内容（不修改源文件）                    |
      | i    | sed ‘2i Line1.5’ test.txt     | 在第2行前插入内容（不修改源文件）                    |
      | d    | sed ‘2d’ test.txt             | 删除第2行（不修改源文件）                            |
      | h    | sed ‘h’ test.txt              | 将模式空间中的内容复制到暂存缓存区                   |
      | H    | sed ‘H’ test.txt              | 将模式空间中的内容追加到暂存缓存区，                 |
      | g    | sed ‘g’ test.txt              | 将暂存缓存区的内容复制到模式空间，覆盖原有内容       |
      | G    | sed ‘G’ test.txt              | 将暂存缓存区的内容追加到模式空间，追加在现有内容之后 |
      | l    | sed ‘l’ test.txt              | 列出非打印字符（不能够显示或者打印出来）             |
      | p    | sed ‘1p’ test.txt             | 打印第一行和暂存缓存区的内容                         |
      | n    | sed ‘n;p’ test.txt            | 打印暂存缓存区的内容和 test.txt 的偶数行             |
      | q    | sed ‘2q’ test.txt             | 显示 test.txt 的前两行并退出 sed                     |
      | r    | sed ‘r’ test.txt              | 读取 test.txt 的所有行                               |
      | s    | sed ‘s/line1/line9/’ test.txt | 替换文本                                             |
      | y    | sed ‘y/L/l/’ test.txt         | 切换大小写                                           |



## Awk 文本处理工具

Alfred Aho, Peter Weinberger, Brian Kernighan 独立语言的文本处理工具，功能强大的数据处理引擎之一。配备编程语言，可自定义变量、使用流程控制语句等。

> awk 在处理文件时以行为单位读取文件。

1. 简介：

   1. awk 读取文件时，会根据用户设置的**匹配模式**和**处理脚本**对文件进行逐行的扫描和修改。没有匹配模式时则匹配所有数据行。

   2. 两种控制程序执行流程的特殊模式：`BEGIN`模式和`END`模式。

      - BEGIN 块中的内容会优先于程序主体被执行（多用于初始化变量）；
      - END 块中的内容会在主体程序执行完毕后执行（多用于文件处理结构的输出）。

      ```
      BEGIN {commands1} # commands1 为 BEGIN 块中需要执行的代码
      END {commands2} # commands2 为 END 块中需要执行的代码
      ```

   3. 命令格式：
      `awk [-Field-seperator] ‘commands’ input-file(s)` 
      参数介绍

      | 格式               | 说明             |
      | ------------------ | ---------------- |
      | [-Field-separator] | awk 命令的可选项 |
      | ‘commands’         | 指令             |
      | input-file(s)      | 操作文件         |

2. awk 语法规则：awk 命令后可加选项与指令，以下是对选项与指令的具体介绍。

   1. 选项：

      | 选项                     | 说明                                 |
      | ------------------------ | ------------------------------------ |
      | -F                       | 指定字段分隔符                       |
      | -v                       | 在程序执行前为变量赋值               |
      | -W dump-variables[=file] | 将全局变量和对应值按序输出到指定文件 |
      | –help                    | 显示帮助信息                         |
      | –lint[=fatal]            | 检查程序的不兼容性                   |
      | –posix                   | 打开严格 POSIX 兼容性检查            |
      | -profile[=file]          | 格式化输出 awk 脚本                  |
      | –traditional             | 禁止 GAWK 扩展                       |
      | –version                 | 显示 awk 版本信息                    |

      打印全局变量：
      `awk -W dump-variables=out.txt 'x=1 {print x}' test.txt`

      这个命令在与 test.txt 相同的目录下输出一个 out.txt 文件，但是不知道输出文件是什么意思。

      awk 默认使用空格最为域分隔符（也可以称为字段分隔符），如果遇到使用“：”或“；”作为字段分隔符的文本，可以通过`-F`选项指定变量的分隔符。
      使用`-F`选项指定字段分隔符为“:”，打印 /etc/passwd 的前两个字段，设置默认分隔符读取，如示例代码所示：
      `awk -F: '{print $1,$2}' /etc/passwd`

   2. 指令：awk 命令中的指令包括**内建变量、算数运算、逻辑运算与流程控制**。

      1. 内建变量：awk 提供了 10 种默认变量，无需用户自定义。

         | 内建变量名称 | 描述                             |
         | ------------ | -------------------------------- |
         | ARGC         | 命令行参数个数                   |
         | FNR          | 当前输入文档的记录编号           |
         | FILENAME     | 当前输入文档的名称               |
         | NR           | 输入流的当前记录编号，行号       |
         | NF           | 当前记录的字段个数               |
         | RS           | 输入记录分隔符，默认为换行符`\n` |
         | OFS          | 输出字段分隔符，默认问空格       |
         | ORS          | 输出记录分隔符，默认为换行符`\n` |
         | FS           | 字段分隔符                       |
         | LENGTH       | 输出字符串长度                   |

         例 1：输出 test.txt 文档中的记录编号、当前记录的字段个数：

         `awk '{print FNR}' test.txt`

         `awk '{print NF}' test.txt`

         例 2：将输出字段分隔符设置为 “：”，使用 print 输出三个字段：

         `awk 'OFS=":" {print $1,$2,$3}' test.txt`

      2. 算数运算符：运算符和变量是表达式的重要组成部分。

         1. 变量：awk 中有两种变量类型：字符变量和数字变量。变量在没有初始化之前默认为 0 或者空字符串，变量定义格式如下：

            ```
            a='Welcome to study Linux' # 字符变量
            b=72	# 数字变量
            ```

         2. 算数运算符：awk、中的算数运算符与 C 语言中的算数运算符类似，常用作数字类型变量的数学运算。

            | 运算符 | 说明               |
            | ------ | ------------------ |
            | +      | 加运算             |
            | -      | 减运算             |
            | *      | 乘运算             |
            | /      | 除运算             |
            | %      | 取余运算           |
            | ^      | 幂运算（乘方运算） |
            | ++     | 自加 1 ，          |
            | –      | 自减 1             |
            | +=     | 相加后赋值给变量   |
            | -=     | 相减后赋值给变量   |
            | /=     | 相除后赋值给变量   |

            例 1：使用 awk 命令定义数字类型变量 x，对 x 进行加减乘除运算：
            `echo | awk 'x=10 {print x+10}'`

         3. 逻辑运算符。

            | 运算符   | 说明                                                  |
            | -------- | ----------------------------------------------------- |
            | >        |                                                       |
            | <        |                                                       |
            | >=       |                                                       |
            | <=       |                                                       |
            | ==       |                                                       |
            | !=       |                                                       |
            | ~        | 匹配                                                  |
            | !~       | 不匹配                                                |
            | &&       | 逻辑与                                                |
            | \|\|     | 逻辑或                                                |
            | ?"1":"2" | 判断问号之前的条件是否成立，若成立返回，若不成立返回2 |

            例1：编写一个 awk 脚本，声明 x，y 两个变量分别赋予 10 和 20，并使用逻辑运算符连接两个变量得到判断结果：

            ```
            # awk.sh 脚本文件
            
            {a=10; b=20; 
            print a==b?"ok":"err";}
            
            # 命令方式
            echo | awk '{a=10; b=20; print a<b?"ok":"err";}'
            ```

         4. 流程控制：条件判断语句`if`，循环语句`for`，跳出本次循环`continue`，跳出循环`break`，循环语句`while`。

            例 1：`echo | awk '{waterlevel=20; if(waterlevel>15) print "warning"; else print "safety"}'`

            例 2：`awk 'BEGIN {x=0; for(i=1; i<=10; i++) x+=i; if(i=10) print x}'`

            `awk 'BEGIN {x=1; for(i=1; i<10; i++) x*=i; if(i=10) print x}'`

            例 3：输出文档的偶数列：
            `awk '{for(i=1; i<=10; i++) if(i%2==0) print $i}' test.txt`

            例 4：`while`循环，求 1-100 的累加和，对比`do while`和`while do`的区别：
            `awk 'BEGIN{total=0; do{total+=i; i++} while(i<=100); print total}'`

            `awk 'BEGIN{total=0; while(i<=100){total+=i; i++;} print total;}'`

            **注意**：`do while`比`while`多执行一次循环体的内容。

         5. Continue，跳出本次循环，终止本次循环，进入下一次循环。
            `awk '{for(i=1; i<=10; i++) if(i%2==0) {continue} else {print $i}}' test.txt`

         6. break，终止循环，跳出整个循环。
            `awk '{for(i=1; i<=10; i++) if(i==6){break}else if(i%2==0) {print $i}}' test.txt`

         7. `awk`单引号和双引号是不同的。

## Linux 字符处理

类似 C 语言中函数功能的文本操作命令，简单完成文本文件内容的排序、截取、合并、转换等功能。

1. sort 文本排序：`sort [选项]... [文件]...`
   sort 命令常用选项

| 选项      | 说明                       |
| --------- | -------------------------- |
| --version | 显示版本信息               |
| –help     | 显示帮助信息               |
| -n        | 采用数字排序               |
| -t        | 指定分隔符                 |
| -k        | 指定第几列                 |
| -r        | 反向排序                   |
| -i        | 忽略无法打印的字符         |
| -o        | 将排序后的结果存入指定文档 |

2. grep 文本搜索：
   `grep [选项] '匹配字符' 查找文件`
   grep 文本搜索参数

   | 选项 | 说明                                             |
   | ---- | ------------------------------------------------ |
   | -i   | 不区分大小写                                     |
   | -c   | 计算符合范本样式的列数                           |
   | -n   | 在显示符合范本样式的那一列之前，标识出该列的编号 |
   | -v   | 反转查找                                         |
   | -o   | 只输出匹配内容                                   |

   ```
   grep -o "lin1" test.txt
   grep -n "line1" test.txt
   ```

3. tr 文本转换：使用一个指定字符去替换文本中的某个字符，文档中完全删除某个字符或者去除文本中的重复字符：
   `tr [选项] (参数)`

   1. 文本转换选项：

   | 选项     | 说明                 |
   | -------- | -------------------- |
   | -d       | 删除指定字符         |
   | -s       | 将重复字符缩减到一个 |
   | –help    | 显示帮助信息         |
   | –version | 显示版本信息         |

   2. 参数包括字符集 1 与字符集 2。
      字符集 1：指定要进行操作的原字符集；
      字符集 2：执行转换操作时，必须使用参数“字符集 2”指定转换的目标字符集。但执行删除操作时，不需要参数“字符集 2”。
      例 1：小写 e 转换为大写 E： `cat test.txt | tr '[e]' '[E]'`
      例 2：将文件中重复的 o 缩减到 1 个：`cat test.txt | tr -s '[o]'`

4. uniq 删除重复内容：`uniq [选项]`

   | 选项 | 说明         |
   | ---- | ------------ |
   | -i   | 忽略大小写   |
   | -c   | 计算重复行数 |

   使用 uniq 删除重复行时需要与 sort 排序配合一起使用，因为 uniq 命令只会删除连续的完全一致的行，经过排序后完全一致的行会并列到一起。

   ```
   cat repetition.txt | uniq
   cat repetition.txt | sort | uniq
   cat repetition.txt | sort | uniq -c
   ```

5. paste 文本合并：系统中出现大量相同类型的文件时，为了方便进行集中管理，需要将这些大量类似小文件进行合并。paste 命令能够将文本文档按照行的方式进行合并，并使用 Tab 进行分隔，命令格式如下：
   `paste [选项] file_name1 file_name2 # filename 是两个要合并的文本文档`

   | 选项 | 说明                             |
   | ---- | -------------------------------- |
   | -d   | 指定分隔符                       |
   | -s   | 将每个文件合并成行但不是按行粘贴 |
   | -    | 使用标准输入                     |

   ```
   paste paste1.txt paste2.txt
   paste -d: paste1.txt paste2.txt
   ```

## 任务 4：

1. 使用 vim 创建文件并在其中添加内容。
2. 使用 sed 工具 修改文件在暂存缓存区的内容，并将修改后的内容作用到源文件中。
3. 使用 awk 工具统计文件中的字符数量和字段数量，并使用指定的分隔符输出文件的前四个字段。

```
cat # 查看内容
sed 's/stars/moonshine/1' sunandstars.txt # 替换缓冲区内容，最后的 l 不知道是什么意思

# 编写脚本替换
vim sed.sh
s/stars/monnshine/g # 脚本文件内容

sed -f -sed.sh sunandstars.txt # 执行脚本

# 将源文件中的内容进行替换
sed -i 's/stars/moonshine/g' sunandstars.txt

# 在第一行后增加一行，并查看源文件内容
sed -i '1a In the eyes of the strong, there is no best but better' sunandstars.txt

# awk 命令查看文件字数和字段个数
awk '{print length}' sunandstars.txt
awk '{print NF}' sunandstars.txt

# 使用 sed 命令将源文件中的空格替换为 ：，并使用 awk 以 ：作为分隔符输出文件.
sed -i 's/ /:/g' sunandstars.txt
awk 'BEGIN{FS=":"} {print $1,$2,$3,$4}' sunandstars.txt # 这一行的双引号不能用单引号替代

# awk 输出第一列到第 10 列之间的偶数列
awk 'BEGIN{FS=":"} {for(i=1;i<=10;i++) if(i%2 !=0) {continue} else{print $i}}' sunandstars.txt

# sed 显示指定行的内容
sed -n '1,7p' scotty.txt # -n 表示取消暂存缓存区的显示，只显示原文本
```





